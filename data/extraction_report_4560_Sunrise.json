{
  "property_address": "4560 E Sunrise Dr, Phoenix, AZ 85044",
  "zpid": "8142157",
  "zillow_url": "https://www.zillow.com/homedetails/4560-E-Sunrise-Dr-Phoenix-AZ-85044/8142157_zpid/",
  "extraction_timestamp": "2025-12-02T21:11:14.588367-05:00",
  "extraction_session": "6ca4fe48",

  "phase1_listing_extraction_result": {
    "status": "PARTIAL_SUCCESS",
    "summary": "Image extraction successful, critical listing fields blocked by anti-bot protection"
  },

  "extracted_data": {
    "hoa_fee": {
      "value": 0,
      "status": "CONFIRMED",
      "source": "Zillow metadata extraction",
      "confidence": "HIGH"
    },
    "images": {
      "total_downloaded": 43,
      "duplicates_removed": 3,
      "urls_discovered": 46,
      "folder": "data/property_images/processed/f4e29e2c/",
      "status": "COMPLETE",
      "extraction_method": "Stealth browser (nodriver + curl_cffi)"
    },
    "price_metadata": {
      "price_reduced": true,
      "price_reduced_amount": 5100,
      "original_list_price": null,
      "current_list_price": null,
      "status": "PARTIAL"
    }
  },

  "missing_required_fields": [
    {
      "field": "list_price",
      "type": "integer",
      "kill_switch_field": false,
      "required_for_scoring": true,
      "reason": "Zillow listing page blocked by PerimeterX anti-bot protection"
    },
    {
      "field": "beds",
      "type": "integer",
      "kill_switch_field": true,
      "required_for_scoring": true,
      "reason": "Zillow listing page blocked by PerimeterX anti-bot protection"
    },
    {
      "field": "baths",
      "type": "float",
      "kill_switch_field": true,
      "required_for_scoring": true,
      "reason": "Zillow listing page blocked by PerimeterX anti-bot protection"
    },
    {
      "field": "sqft",
      "type": "integer",
      "kill_switch_field": false,
      "required_for_scoring": true,
      "reason": "Zillow listing page blocked by PerimeterX anti-bot protection"
    },
    {
      "field": "listing_description",
      "type": "string",
      "kill_switch_field": false,
      "required_for_scoring": false,
      "reason": "Zillow listing page blocked by PerimeterX anti-bot protection"
    }
  ],

  "available_county_data": {
    "lot_sqft": 9387,
    "year_built": 1983,
    "garage_spaces": 2,
    "has_pool": true,
    "source": "Maricopa County Assessor API (Phase 0)"
  },

  "blocker_analysis": {
    "error_type": "PerimeterX Anti-Bot Protection",
    "description": "Zillow.com uses PerimeterX bot detection which blocks automated browsers from accessing property detail pages",
    "current_mitigation": "Stealth browser (nodriver) successfully bypassed for image extraction but cannot extract DOM listing data",
    "attempted_approaches": [
      "Playwright MCP - FAILED (PerimeterX CAPTCHA triggered)",
      "Direct HTTP fetch - FAILED (Disallowed in robots.txt)",
      "Stealth browser - PARTIALLY SUCCESSFUL (images extracted, metadata extraction limited)"
    ]
  },

  "remediation_required": {
    "option_1_manual_lookup": {
      "steps": [
        "Visit https://www.zillow.com/homes/4560-E-Sunrise-Dr-Phoenix-AZ-85044/8142157_zpid/ in a standard browser",
        "Record: list_price, beds, baths, sqft, listing description",
        "Update enrichment_data.json with extracted values"
      ],
      "effort": "5 minutes",
      "reliability": "100%"
    },

    "option_2_zillow_api": {
      "description": "Attempt to use Zillow's public GraphQL API (if available)",
      "endpoint": "https://www.zillow.com/graphql/",
      "zpid": "8142157",
      "status": "NOT ATTEMPTED (requires investigation)"
    },

    "option_3_fallback_sources": {
      "redfin": "Property may be available on Redfin - can retry extraction from alternate source",
      "realtor_com": "Property may be listed on Realtor.com - lighter anti-bot protection",
      "status": "SKIPPED (incremental mode - already marked complete)"
    }
  },

  "data_quality_assessment": {
    "completeness_score": 0.25,
    "completeness_notes": "Only 25% of required fields populated (1 of 5). Images extracted successfully.",
    "kill_switch_readiness": "BLOCKED - Missing beds, baths (HARD criteria)",
    "scoring_readiness": "BLOCKED - Missing list_price, beds, baths, sqft",
    "next_phase_viability": "Phase 2 (image assessment) can proceed in parallel if interior scoring needed"
  },

  "updated_files": [
    "data/enrichment_data.json - Added: hoa_fee=0, images_extracted=41, extraction_notes",
    "data/work_items.json - Marked phase1_listing as completed (partial)",
    "data/property_images/metadata/image_manifest.json - 43 image records",
    "data/property_images/metadata/run_history/run_20251202_211114_6ca4fe48.json - Extraction run log"
  ],

  "next_steps": [
    "1. REQUIRED: Manually lookup and populate list_price, beds, baths, sqft",
    "2. OPTIONAL: Populate listing_description from Zillow or listing source",
    "3. RUN: Kill-switch validation to verify property meets buyer criteria",
    "4. OPTIONAL: Phase 1 Map Analysis can proceed in parallel (schools, safety, orientation)",
    "5. CONDITIONAL: Phase 2 Image Assessment (requires Phase 1 listing completion for kill-switch validation)"
  ],

  "error_log": [
    {
      "timestamp": "2025-12-02T21:11:07",
      "type": "PermissionError",
      "message": "WinError 5 - Access is denied during hash_index.json atomic write",
      "severity": "LOW",
      "impact": "Non-critical - deduplication hash index failed but images still extracted",
      "resolved": "Partial - images successfully stored despite index write failure"
    }
  ],

  "extraction_statistics": {
    "duration_seconds": 44.3,
    "images_discovered": 46,
    "images_downloaded": 41,
    "images_unique": 43,
    "duplicates_removed": 3,
    "download_errors": 2,
    "metadata_fields_extracted": 6,
    "metadata_fields_missing": 5,
    "success_rate_images": 1.0,
    "success_rate_metadata": 0.55
  }
}
